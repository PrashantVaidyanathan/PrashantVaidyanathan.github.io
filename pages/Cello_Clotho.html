<!DOCTYPE html>
<html>
<head>
<script type="text/javascript" src="../JS/clotho3API.js"></script>
<script >
function onSubmitBtnClick()
{
	var text = document.getElementById("gateupload").value;
	window.alert(text);
}
function onUploadFileClick()
{
	if(!(window.File && window.FileReader && window.FileList && window.Blob))
	{
		alert('File APIs are not fully supported in this browser. This may cause issues.');
	}
}
window.onload = function()
{
	var fileinput = document.getElementById('gateuploadbtn');
	var gatetextarea = document.getElementById('gateupload');
	fileinput.addEventListener('change',
	function(e) 
	{
		var file = fileinput.files[0];
		var textType = /text.*/;
		if(file.type.match(textType))
		{
			var fileReader = new FileReader();
			fileReader.onload = function(e) 
			{
				gatetextarea.innerText = fileReader.result;
			}
			fileReader.readAsText(file);
		}
		else
		{
			alert("Please Upload a Valid Text file");
		}
	});
}

function readSampleGatesFile()
{
	var gatetextarea = document.getElementById('gateupload');
	var txtFile = new XMLHttpRequest();
	txtFile.open("GET", "http://prashantvaidyanathan.github.io/resources/SampleGates.txt", true);
	txtFile.onreadystatechange = function() 
	{
		if (txtFile.readyState === 4) 
		{ 
			if (txtFile.status === 200) 
			{ 
				allText = txtFile.responseText; 
				gatetextarea.innerText = allText;
			}
		}
	}
	txtFile.send(null);
}

</script>

</head>
<title>

</title>

<body>






<div align="center">
<h1 style="font-family:Arial, Helvetica, sans-serif;">Upload Cello Gates</h1> 
<button id="connect" type="button" class="btn btn-primary btn-lg">Connect</button>
<textarea id="gateupload" rows="30" cols="60"> </textarea>
</div>
<div align="center">
<input type="file"  id="gateuploadbtn">
<input type="button" value="Upload Sample File" onclick="readSampleGatesFile()">
<input type="submit" id="submitbtn" onclick="onSubmitBtnClick()" />
</div>
<script>
            $(document).ready(function() { 
                $("#connect").click(function() {
                    alert("Connecting");
                });
                $("#get").click(function() {
                    Clotho.get("My New Part").then(function(data) {
                        alert(data.name);
                    }).done();
                });
                $("#query").click(function() {
                    Clotho.query("schema", "CompositePart").then(function(data) {
                        alert(data.length);
                    }).done();
                });
                $("#queryOne").click(function() {
                    Clotho.queryOne("schema", "CompositePart").then(function(data) {
                        alert(data.name);
                    }).done();
                });
                $("#create").click(function() {
                    obj = {"name":"My New Part", "sequence":"GGGGGG"};
                    Clotho.create(obj);
                    Clotho.get("My New Part").then(function(data) {
                        alert(data.sequence);
                    }).done();
                    // Clotho.create(obj).then(function(id) {
                    //     Clotho.get(id).then(function(data) {
                    //         alert(data.sequence);
                    //     }).done();
                    // });
                });
                $("#createAll").click(function() {
                    Clotho.create([{"name":"My New Part", "sequence":"GGGGGG"},{"name":"My Second Part", "sequence":"AAACCC"}]).then(function(id) {
                        alert(JSON.stringify(id));        
                    }).done();
                });
                $("#destroy").click(function() {
                    Clotho.destroy("My New Part");
                });
                $("#set").click(function() {
                    Clotho.get("Test Part 1").then(function(data) {
                        alert(data.name);
                        storeID = data.id;
                        Clotho.set({"id":storeID, "name":"Kev's Trial Part"}).then(function(data2) {
                            Clotho.get(storeID).then(function(data3) {
                                alert(data3.name);
                                Clotho.set({"id":storeID, "name":"Test Part 1"}).then(function(data4) {
                                    Clotho.get(storeID).then(function(data5) {
                                        alert(data5.name);
                                    }).done()
                                });
                            });
                        });
                    });
                });
            });
        </script>

</body>
</html>
